(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a2338532"],{"09cc":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"amap-wrap"},[a("el-amap",{staticClass:"amap-demo",attrs:{vid:"amapContainer",events:t.events}})],1)},i=[],r=(a("d81d"),a("8f9b"));function o(t){return{lng:t.lnglat.getLng(),lat:t.lnglat.getLat(),value:t.lnglat.getLng()+","+t.lnglat.getLat()}}var s=null;function l(t,e){s&&(e.remove(s),s=null),s=new AMap.Marker({position:[t.lng,t.lat]}),e.add(s),e.setFitView()}function c(t){s&&(t.remove(s),s=null)}function u(t,e){var a=new AMap.Geocoder;a.getLocation(t,(function(t,a){if("complete"===t&&"OK"==a.info){var n=a.geocodes[0].location.lat,i=a.geocodes[0].location.lng;e.setCenter([i,n])}else log.error("根据地址查询位置失败")}))}var d={name:"amap",data:function(){return{lnglat:{},map:null,zoom:15,events:{}}},props:{options:{type:Object,default:function(){}}},mounted:function(){var t=this;r["lazyAMapApiLoaderInstance"].load().then((function(){t.mapCreate(),t.map.on("click",(function(e){t.lnglat=o(e),t.$emit("lnglat",t.lnglat),t.setMarker()}))}))},methods:{setMapCenter:function(t){u(t,this.map)},setMarker:function(t){l(t||this.lnglat,this.map)},clearMarker:function(){c(this.map)},mapDestory:function(){this.map&&this.map.destroy()},mapCreate:function(t){var e=this;this.map=new AMap.Map("amapContainer",{center:[116.404765,39.918052],zoom:this.zoom}),this.map.on("complete",(function(){e.mapLoad()}))},mapLoad:function(){this.options.mapLoad&&this.$emit("mapLoad")}}},p=d,f=(a("8a97"),a("2877")),h=Object(f["a"])(p,n,i,!1,null,"7c1e735b",null);e["a"]=h.exports},1276:function(t,e,a){"use strict";var n=a("d784"),i=a("44e7"),r=a("825a"),o=a("1d80"),s=a("4840"),l=a("8aa5"),c=a("50c4"),u=a("14c3"),d=a("9263"),p=a("d039"),f=[].push,h=Math.min,m=4294967295,g=!p((function(){return!RegExp(m,"y")}));n("split",2,(function(t,e,a){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,a){var n=String(o(this)),r=void 0===a?m:a>>>0;if(0===r)return[];if(void 0===t)return[n];if(!i(t))return e.call(n,t,r);var s,l,c,u=[],p=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),h=0,g=new RegExp(t.source,p+"g");while(s=d.call(g,n)){if(l=g.lastIndex,l>h&&(u.push(n.slice(h,s.index)),s.length>1&&s.index<n.length&&f.apply(u,s.slice(1)),c=s[0].length,h=l,u.length>=r))break;g.lastIndex===s.index&&g.lastIndex++}return h===n.length?!c&&g.test("")||u.push(""):u.push(n.slice(h)),u.length>r?u.slice(0,r):u}:"0".split(void 0,0).length?function(t,a){return void 0===t&&0===a?[]:e.call(this,t,a)}:e,[function(e,a){var i=o(this),r=void 0==e?void 0:e[t];return void 0!==r?r.call(e,i,a):n.call(String(i),e,a)},function(t,i){var o=a(n,t,this,i,n!==e);if(o.done)return o.value;var d=r(t),p=String(this),f=s(d,RegExp),v=d.unicode,b=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(g?"y":"g"),y=new f(g?d:"^(?:"+d.source+")",b),k=void 0===i?m:i>>>0;if(0===k)return[];if(0===p.length)return null===u(y,p)?[p]:[];var _=0,$=0,C=[];while($<p.length){y.lastIndex=g?$:0;var M,A=u(y,g?p:p.slice($));if(null===A||(M=h(c(y.lastIndex+(g?0:$)),p.length))===_)$=l(p,$,v);else{if(C.push(p.slice(_,$)),C.length===k)return C;for(var L=1;L<=A.length-1;L++)if(C.push(A[L]),C.length===k)return C;$=_=M}}return C.push(p.slice(_)),C}]}),!g)},"79ba":function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return o})),a.d(e,"d",(function(){return s}));var n=a("b775");function i(t){return n["a"].request({method:"post",url:"/parking/add/",data:t})}function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n["a"].request({method:"post",url:"/parking/detailed/",data:t})}function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n["a"].request({method:"post",url:"/parking/edit/",data:t})}function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n["a"].request({method:"post",url:"/parking/status/",data:t})}},"8a77":function(t,e,a){},"8a97":function(t,e,a){"use strict";var n=a("8a77"),i=a.n(n);i.a},a15b:function(t,e,a){"use strict";var n=a("23e7"),i=a("44ad"),r=a("fc6a"),o=a("a640"),s=[].join,l=i!=Object,c=o("join",",");n({target:"Array",proto:!0,forced:l||!c},{join:function(t){return s.call(r(this),void 0===t?",":t)}})},ae88:function(t,e,a){"use strict";var n=a("e3f0"),i=a.n(n);i.a},c016:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-cascader",{ref:"cascaderAddr",attrs:{options:t.cascader_options,props:t.cascader_props,placeholder:t.initValue},on:{change:t.changeValue},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)},i=[],r=(a("a15b"),a("ac1f"),a("1276"),a("b85c")),o=a("2934"),s={name:"CityArea",data:function(){return{addressDate:{},address:[],value:"",cascader_options:[],cascader_props:{lazy:!0,lazyLoad:function(t,e){var a=t.level,n={},i={0:{type:"province"},1:{type:"city",code:"province"},2:{type:"area",code:"city"}};n.type=i[a].type,i[a].code&&(n["".concat(i[a].code,"_code")]=t.value),Object(o["b"])(n).then((function(t){var n,o=t.data.data.data,s=i[a].type.toUpperCase(),l=Object(r["a"])(o);try{for(l.s();!(n=l.n()).done;){var c=n.value;c.value=c["".concat(s,"_CODE")],c.label=c["".concat(s,"_NAME")],c.leaf=a>=2}}catch(u){l.e(u)}finally{l.f()}e(o)}))}},initValue:"请选择省市区"}},methods:{initDefault:function(t){t&&(this.initValue=t.split(",").join(" / "))},changeValue:function(t){this.$emit("getcity",t.join()),this.$emit("update:cityAreaValue",t.join()),this.mapLocation&&(this.address=this.$refs["cascaderAddr"].getCheckedNodes()[0].pathLabels,this.$emit("callback",this.address.join("")))},clear:function(){this.value=""}},props:{mapLocation:{type:Boolean,default:!1}}},l=s,c=a("2877"),u=Object(c["a"])(l,n,i,!1,null,null,null);e["a"]=u.exports},d81d:function(t,e,a){"use strict";var n=a("23e7"),i=a("b727").map,r=a("1dde"),o=a("ae40"),s=r("map"),l=o("map");n({target:"Array",proto:!0,forced:!s||!l},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},e3f0:function(t,e,a){},fe39:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"parking-add"},[a("VueForm",{ref:"vuForm",attrs:{formItem:t.form_item,form_handler:t.form_handler,formData:t.form},scopedSlots:t._u([{key:"city",fn:function(){return[a("CityArea",{ref:"cityArea",attrs:{mapLocation:!0},on:{getcity:t.getcity,callback:t.setMapCenter}})]},proxy:!0},{key:"amap",fn:function(){return[a("div",{staticClass:"addrss-map"},[a("a-map",{ref:"amap",attrs:{options:t.option_map},on:{lnglat:t.lnglat,mapLoad:t.mapLoad}})],1)]},proxy:!0}])})],1)},i=[],r=(a("caad"),a("b64b"),a("ac1f"),a("2532"),a("1276"),a("09cc")),o=a("79ba"),s=a("c016"),l=a("a8b5"),c={name:"ParkingAdd",data:function(){var t=this,e=function(t,e,a){var n=/^[0-9]*$/;e?n.test(e)?a():a(new Error("请输入数字")):a(new Error("请输入可停放车辆"))};return{form_item:[{type:"input",label:"停车场名称",placeholder:"停车场名称",prop:"parkingName",required:!0,requiredMsg:"请输入停车场名称"},{type:"slot",slotName:"city",label:"区域",prop:"area",requiredMsg:"请选择省市区"},{type:"input",label:"详细地址",placeholder:"请输入详细地址",required:!0,prop:"address"},{type:"radio",label:"类型",prop:"type",required:!0,options:this.$store.state.config.parking_type},{type:"input",label:"可停放车辆",prop:"carsNumber",validator:[{validator:e,trigger:"change"}]},{type:"radio",label:"禁启用",prop:"status",required:!0,options:this.$store.state.config.radio_disabled},{type:"slot",slotName:"amap",label:"位置"},{type:"input",label:"经纬度",prop:"lnglat",disabled:!0}],form_handler:[{label:"确定",type:"danger",handler:function(){return t.onSubmit()}},{label:"重置",type:""}],id:this.$route.query.id,option_map:{mapLoad:!0},status:this.$store.state.config.radio_disabled,type:this.$store.state.config.parking_type,form:{parkingName:"",area:"",address:"",type:"",carsNumber:"",status:"",lnglat:""},btn_loading:!1}},components:{AMap:r["a"],CityArea:s["a"],VueForm:l["a"]},methods:{onSubmit:function(){var t=this;this.$refs.vuForm.$refs.form.validate((function(e){if(!e)return console.log("error submit!!"),!1;t.id?t.editParking():t.addParking(),t.message}))},addParking:function(){var t=this;this.btn_loading=!0,Object(o["a"])(this.form).then((function(e){t.btn_loading=!1,t.$message({message:e.data.message,type:"success"}),t.reset()})).catch((function(e){t.btn_loading=!1}))},editParking:function(){var t=this,e=JSON.parse(JSON.stringify(this.form));e.id=this.id,this.btn_loading=!0,Object(o["c"])(e).then((function(e){t.btn_loading=!1,t.$message({message:e.data.message,type:"success"}),t.$router.push("/ParkingIndex")})).catch((function(e){t.btn_loading=!1}))},getDetail:function(){var t=this;if(this.id){var e={id:this.id};Object(o["b"])(e).then((function(e){var a=e.data.data;for(var n in a)Object.keys(t.form).includes(n)&&(t.form[n]=a[n]);var i=a.lnglat.split(","),r={lng:i[0],lat:i[1]};t.$refs.amap.setMarker(r),t.$refs.cityArea.initDefault(a.region)}))}},mapLoad:function(){this.getDetail()},getcity:function(t){this.form.area=t},lnglat:function(t){this.form.lnglat=t.value,console.log(this.form.lnglat)},setMapCenter:function(t){this.$refs.amap.setMapCenter(t)},reset:function(){this.$refs.vuForm.$refs.form.resetFields(),this.$refs.cityArea.clear(),this.$refs.amap.clearMarker()}}},u=c,d=(a("ae88"),a("2877")),p=Object(d["a"])(u,n,i,!1,null,null,null);e["default"]=p.exports}}]);